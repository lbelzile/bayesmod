{
  "hash": "5ff0956b0827c54ececa3e7ce78871e6",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Assignment 1\"\n---\n\n\n\n\nThese problems are for credit and to be handed in by the beginning of class 5.\n\n## Problem 1.1\n\n\nConsider the geometric distribution $\\mathsf{geom}(p)$ with mass function\n\\begin{align*}\nf(y; p) = p(1-p)^{y}, \\qquad y = 0, 1, 2, \\ldots;\n\\end{align*}\nthe latter is used to model the number of failures $Y$ from independent trials until a first success, which occurs with probability $p$.\n\na. If $Y \\mid P=p \\sim \\mathsf{geom}(p)$ and $P \\sim \\mathsf{beta}(\\alpha_1, \\alpha_2)$, show that $P \\mid Y=y$ is beta distributed and obtain the parameters of the latter.\nb. Obtain the marginal distribution of $Y$ and show that it is a special case of the beta-negative binomial distribution.\nc. Using the tower property, compute the unconditional mean and variance of $Y$. **Hint**: the formulae will depend on the reciprocal moments of a beta distribution,  $\\mathsf{E}_P(P^{-1})$ and $\\mathsf{E}_P(P^{-2})$. Complete the kernel to obtain these using the property $\\Gamma(\\alpha+1) = \\alpha \\Gamma(\\alpha)$.\nd. **Forward sampling**: generate data from the marginal of $Y$ as follows\n   1. Pick values for $(\\alpha_1, \\alpha_2)$.\n   2. Draw 10 000 observations from $Y$ by first simulating from $P$, then from $Y \\mid P$. \n   3. Discard the values of $P$ and keep only those for $Y$. \n   4. Compare the distribution with that of $Y \\mid p$ using a bar plot.\ne. Verify the formulas for the expected value and variance derived previously using Monte Carlo integration (need $\\alpha_1 > 3$).\n\n\n## Problem 1.2\n\nThe `sweden` data contains the number of accidents $Y$ per day in Sweden for 1961--1962. Some days, a speed `limit` was in place on specified days (`day`) of each year. We write the mean model as\n\\begin{align*}\n\\mathsf{E}(Y_i; \\lambda_0, \\lambda_1) &= \\exp(\\beta_0 + \\beta_1\\texttt{limit}_i)\n\\\\&= \\begin{cases} \\lambda_0 & \\texttt{limit}_i=0 \\\\ \\lambda_1 & \\texttt{limit}_i=1.\\end{cases}\n\\end{align*}\n\nAssume each of the 184 observations are independent from two Poisson populations with mean $\\lambda_0$ and $\\lambda_1$, when `limit=0` and `limit=1`, respectively. Check Example 3.5 (Should you phrase your headline as a question?) of the [course notes](https://lbelzile.github.io/MATH80601A/priors.html#exm-poisson-upworthy-question)\n\n1. Use a noninformative conjugate prior and obtain posterior samples for $\\lambda_0$ and $\\lambda_1$. Use these to obtain $B=10 000$ posterior samples for the mean ratio $\\lambda_1/\\lambda_0$ and plot a histogram or density estimator of the latter.\n2. Calculate the posterior probability that the speed limit enforcement reduces the average number of accidents.\n\n\n## Problem 1.3\n\nThe `waiting` time dataset contains waiting time in seconds.\n\n1. Assume that the waiting time are exponential. \n   a. Use a conjugate gamma prior with mean 30 seconds and std. deviation 30 seconds. Give the values of the corresponding shape and rate parameters.\n   b. Plot an histogram of prior predictive draws\n   c. Derive the posterior distribution and give its parameter values.\n   d. Calculate the posterior probability of waiting more than 30 seconds analytically and verify the result via Monte Carlo.\n2. The [`post_waiting_weibull`]() contains 10K random samples from the posterior of a Weibull model $\\mathsf{Weibull}(\\lambda, \\alpha)$ with a penalized-complexity prior for the shape parameter with $\\alpha \\sim \\mathsf{PC}(\\theta=0.5)$ [@vanNiekerk:2021] and  $\\lambda \\sim \\mathsf{inv. gamma}(\\gamma, \\omega)$ with scale $\\gamma=90$ and shape $\\omega=4$.\n    a. Draw 10K samples from the posterior predictive and plot their density. Compare with that obtained from the exponential model.\n    b. Draw next $B=1000$ posterior predictive samples of size $n=62$ from the Weibull and exponential models.\n    c. For each, compute (i) the sample mean, (ii) the sample std. deviation and (iii) the empirical proportion of samples exceeding 30 seconds. Plot an histogram for each of the three summary and each model (Weibull and exponential). Superimpose a vertical line indicating the corresponding function for the original `waiting` sample. Hence comment on the adequacy (or lack thereof) of the two models.\n\n\n\n\n\n::: {.cell}\n\n:::\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}