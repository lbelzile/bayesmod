{
  "hash": "afce35cc6d521587757d40e4c806d0a0",
  "result": {
    "markdown": "---\ntitle: \"Exercice 3\"\n---\n\n\n## Exercise 3.1\n\nWe revisit [Exercise 1.3](/exercises/01-exercise.html#exercice-1.3), which used a half-Cauchy prior for the exponential waiting time of buses.\n\nThe ratio-of-uniform method, implemented in the [`rust` **R** package](https://paulnorthrop.github.io/rust/index.html), can be used to simulate independent draws from the posterior of the rate $\\lambda$.\nThe following code produces \n\n::: {.cell}\n\n```{.r .cell-code}\nnobs <- 10L # number of observations\nybar <- 8   # average waiting time\nB <- 1000L  # number of draws\n# Un-normalized log posterior: scaled log likelihood + log prior\nupost <- function(x){ \n  dgamma(x = x, shape = nobs + 1L, rate = nobs*ybar, log = TRUE) +\n    log(2) + dt(x = x, df = 1, log = TRUE)}\npost_samp <- rust::ru(logf = upost, \n                      n = B, \n                      d = 1,  # dimension of parameter (scalar)\n                      init = nobs/ybar) # initial value of mode\n```\n:::\n\n\nEstimate using the Monte Carlo sample:\n\n1. the probability that the waiting time is between 3 and 15 minutes\n2. the average waiting time\n3. the standard deviation of the waiting time\n\nNext, implement a random walk Metropolis--Hastings algorithm to sample draws from the posterior. Estimate the same quantities and assess the variability of the Monte Carlo estimators for both correlated draws and the independent draws.\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}